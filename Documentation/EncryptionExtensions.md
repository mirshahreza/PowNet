# EncryptionExtensions

Comprehensive symmetric, asymmetric, hashing and key-derivation helpers. Provides modern authenticated encryption (AES?256?GCM), legacy CBC compatibility, RSA (encrypt / decrypt / sign / verify), HMAC, generic hash utilities, random generation, and file encryption helpers.

> ???? (Note): ???? ??????? ?????? ??????? ?????? ?????? ???? ???? (Key Rotation)? ?????? Salt ?????? ???? ? ????? ??????? ???? ?? ???? ??? ??? ?????????? ???.

---
## ????? (Contents)
1. AES?GCM (Authenticated Encryption)
2. AES?CBC Legacy (Encode / Decode)
3. RSA (Keys, Encrypt/Decrypt, Sign/Verify)
4. Hash & HMAC Utilities
5. Key Derivation & Random
6. File Encryption (AES?GCM)
7. Supporting Types
8. Usage Scenarios
9. ????? ? ???????? (Security Notes)

---
## 1. AES?GCM
### EncryptAesGcm(this string plaintext, string key)
Authenticated encryption (confidentiality + integrity) ?? ????? nonce ?????? 96 ???? ? tag 128 ????.
```csharp
string cipher = "Sensitive Data".EncryptAesGcm("passphrase-1");
```
?????: Base64 (nonce || ciphertext || tag)

### DecryptAesGcm(this string ciphertext, string key)
```csharp
string plain = cipher.DecryptAesGcm("passphrase-1");
```
?? ???? ????? tag ?? ???? ??????: `PowNetSecurityException`.

???? ????? ?? PBKDF2 (`DeriveKey`) ?? ??? 32 ???? ??????? ?????? (AES?256).

---
## 2. AES?CBC Legacy (Backward Compatibility)
### Encode(this string plaintext, string key)
???????? CBC ?? IV ?????? 16 ????? (????? Base64 ???? IV + Cipher).
```csharp
string legacy = "Hello".Encode("key123");
```
### Decode(this string ciphertext, string key)
```csharp
string again = legacy.Decode("key123");
```
CBC ???? ???????? ???? ???? ??? ???? ???????? ????? ??????? ???.

---
## 3. RSA
### GenerateRSAKeyPair(int keySize = 2048)
????? ??? ???? (Base64 raw ASN.1 blobs – ?? PEM).
```csharp
var pair = EncryptionExtensions.GenerateRSAKeyPair(3072);
Console.WriteLine(pair.PublicKey);
```

### EncryptRSA(this string plaintext, string publicKey)
OaepSHA256 padding.
```csharp
string enc = "secret".EncryptRSA(pair.PublicKey);
```

### DecryptRSA(this string ciphertext, string privateKey)
```csharp
string dec = enc.DecryptRSA(pair.PrivateKey);
```

### SignRSA(this string data, string privateKey)
PKCS#1 v1.5 (SHA256).
```csharp
string sig = "payload".SignRSA(pair.PrivateKey);
```

### VerifyRSASignature(this string data, this string signature, string publicKey)
False ?? ?? ??? (fail?closed).
```csharp
bool ok = "payload".VerifyRSASignature(sig, pair.PublicKey);
```

PEM Export helpers ??? `RSAKeyPair` ????? ??? (ExportPublicKeyPem / ExportPrivateKeyPem).

---
## 4. Hash & HMAC
### ComputeSHA256 / ComputeSHA512
```csharp
string h256 = "x".ComputeSHA256();
string h512 = "x".ComputeSHA512();
```
????? Base64.

### ComputeHMAC(this string input, string key)
HMAC?SHA256 ?? ???? ???????? (PBKDF2 ????). 
```csharp
string mac = "message".ComputeHMAC("hmac-secret");
```

### VerifyHMAC(this string input, string signature, string key)
?????? ???? ???? ????? (SecureStringCompare).
```csharp
bool valid = "message".VerifyHMAC(mac, "hmac-secret");
```

---
## 5. Key Derivation & Random
### DeriveKey(string password, int keyLength, byte[]? salt = null, int iterations = 100000)
PBKDF2 + SHA256. (Salt ??????? ????: ???? ????? *????? ????* ? ?? ??????? ????? salt ?????? ? ????? ????? ciphertext ???? ???.)
```csharp
byte[] k = EncryptionExtensions.DeriveKey("pass", 32, EncryptionExtensions.GenerateRandomBytes(16));
```

### GenerateRandomBytes(int length)
```csharp
byte[] nonce = EncryptionExtensions.GenerateRandomBytes(12);
```

### GenerateRandomString(int length, string charset = ...)
Pseudo?uniform ?? ???? ?????????? (bias ???? ???? ???? charset ??? ????). 
```csharp
string token = EncryptionExtensions.GenerateRandomString(24);
```

---
## 6. File Encryption (AES?GCM)
### EncryptFile(string inputFilePath, string outputFilePath, string key)
????????: nonce || ciphertext || tag.
```csharp
EncryptionExtensions.EncryptFile("plain.bin", "cipher.bin", "file-key");
```
### DecryptFile(string inputFilePath, string outputFilePath, string key)
```csharp
EncryptionExtensions.DecryptFile("cipher.bin", "plain.out", "file-key");
```
?? ???? ????????: `PowNetSecurityException`.

---
## 7. Supporting Types
### RSAKeyPair
| Property | ????? |
|----------|-------|
| PublicKey | Base64 ??? ???? ????? (ExportRSAPublicKey) |
| PrivateKey | Base64 ??? ???? ????? |
| KeySize | ?????? ???? ??? |
| CreatedAt | ???? ????? |

?????:
- `ExportPublicKeyPem()` / `ExportPrivateKeyPem()` ? ???? PEM ?????????.

### EncryptionContext
?????? ??????? ??????? ???? ?????? ?????? (Algorithm, KeyId, Metadata).

---
## 8. Usage Scenarios
### ????? ??????? ???? (Config Secret)
```csharp
string cipher = configJson.EncryptAesGcm(masterKey);
File.WriteAllText("secure.conf", cipher);
```
### ????? ???? API
```csharp
var pair = EncryptionExtensions.GenerateRSAKeyPair();
string sig = payload.SignRSA(pair.PrivateKey);
bool ok = payload.VerifyRSASignature(sig, pair.PublicKey);
```
### HMAC ???? Webhook ??
```csharp
string mac = body.ComputeHMAC(sharedSecret);
if(!body.VerifyHMAC(mac, sharedSecret)) return Unauthorized();
```
### ????? ???? ?????? ?????
```csharp
string reset = EncryptionExtensions.GenerateRandomString(48);
```

---
## 9. ????? ? ???????? (Security Notes)
- Salt ???? PBKDF2 ?? ?? ????? ????? ?? salt ?????? ??????? ? ???? ciphertext ????? ????.
- ???? ????? ??? ???? ??????? ?? ???????? ????????? (Argon2 / PBKDF2 ?? salt ???? + pepper) ??????? ????? ??? ????? ?? ??? ???? ????? ????? ???????.
- RSA 2048 ????? ???? 3072 ?? 4096 ???? ???????? ????????? ????? ??????.
- AES?GCM ????? ?? nonce ???? ???? ?? ???? ???? ????? ?? ?????????? ???? nonce ?????? ??? (??? ?????? ????? ??)? ???? ??? ???? ??????? ???? ?? DRBG monotonic ????? ????.
- CBC ??? ???? ???????? ?? GCM ???? ???????? ???? ??????? ????.
- HMAC ?????? Base64 ???? ?? ?????? URL ?? ?? URL?encode ?? Base64Url ????.

---
## ????? (Exceptions)
????? ?????? ?? `PowNetSecurityException` ???? ?? (Code) ??? `AES_GCM_ENCRYPT`, `RSA_ENCRYPT` ? ?????????? ???? ????? ???????. ?? ?? ???? ??? ????????? ??????? ????.
